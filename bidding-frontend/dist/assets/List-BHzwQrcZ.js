import{_ as le,u as ae,r as M,b as U,a as se,s as oe,k as v,o as n,h as u,g as t,D as ne,w as l,e as o,G as de,d as _,m as f,f as ie,i as d,F as E,v as $,j as c,t as y,H as re,I as ue,C as ce,J as pe,E as B,K as me}from"./index-Dg0MfX17.js";import{g as _e,d as fe}from"./supplier-Brz4Qjp8.js";const ye={class:"supplier-list container"},ve={key:0,class:"filter-section"},ge={class:"tag-cloud"},ke={class:"card-header"},be={class:"card-title"},we={key:0},he={class:"supplier-logo"},Ce={class:"name"},xe={class:"industry"},Ve={class:"tags"},ze={class:"card-footer"},Ae={class:"pagination"},Le={__name:"List",setup(Se){const b=ie(),N=se(),r=ae(),x=M(!1),V=M([]),q=["全部","信息技术","建筑工程","医疗器械","办公用品","咨询服务","物流运输"],i=U({industry:N.query.industry||"",scale:"",qualificationLevel:"",status:"",keyword:""}),p=U({page:1,size:12,total:0}),w=async()=>{x.value=!0;try{const s={...i};!r.isAdmin()&&s.industry==="全部"&&(s.industry="");const e=await _e({page:p.page,size:p.size,...s});V.value=e.records,p.total=e.total}catch(s){console.error("加载供应商列表失败",s)}finally{x.value=!1}},S=()=>{p.page=1,w()},I=s=>{i.industry=s,S()},R=s=>{b.push(`/suppliers/detail/${s}`)},T=async(s,e)=>{switch(s){case"edit":b.push(`/suppliers/edit/${e}`);break;case"audit":b.push(`/suppliers/audit/${e}`);break;case"delete":await F(e);break}},F=async s=>{try{await me.confirm("确定要删除该供应商吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),await fe(s),B.success("删除成功"),w()}catch(e){e!=="cancel"&&console.error("删除失败",e)}},G=s=>{B.success(`已向 ${s.companyName} 发送联系请求，请等待回复。`)},j=s=>({LARGE:"大型企业",MEDIUM:"中型企业",SMALL:"小型企业"})[s]||s,H=s=>({0:"待审核",1:"已认证",2:"已驳回"})[s]||"未知",J=s=>({0:"info",1:"success",2:"danger"})[s]||"info";return oe(()=>{w()}),(s,e)=>{const h=o("el-tag"),K=o("el-divider"),m=o("el-option"),z=o("el-select"),g=o("el-form-item"),A=o("el-icon"),k=o("el-button"),P=o("el-input"),O=o("el-form"),D=o("el-card"),L=o("el-dropdown-item"),Q=o("el-dropdown-menu"),W=o("el-dropdown"),X=o("el-col"),Y=o("el-row"),Z=o("el-empty"),ee=o("el-pagination"),te=de("loading");return n(),v("div",ye,[e[13]||(e[13]=u("h1",{class:"page-title"},"优质供应商库",-1)),t(D,{class:"filter-card",shadow:"never"},{default:l(()=>[d(r).isAdmin()?f("",!0):(n(),v("div",ve,[e[7]||(e[7]=u("span",{class:"label"},"行业分类：",-1)),u("div",ge,[(n(),v(E,null,$(q,a=>t(h,{key:a,effect:i.industry===a?"dark":"plain",class:"filter-tag",onClick:C=>I(a)},{default:l(()=>[c(y(a),1)]),_:2},1032,["effect","onClick"])),64))])])),d(r).isAdmin()?f("",!0):(n(),_(K,{key:1,"border-style":"dashed"})),t(O,{inline:!0,model:i},{default:l(()=>[t(g,{label:"企业规模"},{default:l(()=>[t(z,{modelValue:i.scale,"onUpdate:modelValue":e[0]||(e[0]=a=>i.scale=a),placeholder:"全部规模",clearable:"",style:{width:"150px"}},{default:l(()=>[t(m,{label:"大型企业",value:"LARGE"}),t(m,{label:"中型企业",value:"MEDIUM"}),t(m,{label:"小型企业",value:"SMALL"})]),_:1},8,["modelValue"])]),_:1}),d(r).isAdmin()?f("",!0):(n(),_(g,{key:0,label:"资质等级"},{default:l(()=>[t(z,{modelValue:i.qualificationLevel,"onUpdate:modelValue":e[1]||(e[1]=a=>i.qualificationLevel=a),placeholder:"全部等级",clearable:"",style:{width:"150px"}},{default:l(()=>[t(m,{label:"一级资质",value:"一级资质"}),t(m,{label:"二级资质",value:"二级资质"}),t(m,{label:"三级资质",value:"三级资质"})]),_:1},8,["modelValue"])]),_:1})),d(r).isAdmin()?(n(),_(g,{key:1,label:"认证状态"},{default:l(()=>[t(z,{modelValue:i.status,"onUpdate:modelValue":e[2]||(e[2]=a=>i.status=a),placeholder:"全部状态",clearable:"",style:{width:"150px"}},{default:l(()=>[t(m,{label:"待审核",value:0}),t(m,{label:"已认证",value:1}),t(m,{label:"已驳回",value:2})]),_:1},8,["modelValue"])]),_:1})):f("",!0),t(g,null,{default:l(()=>[t(P,{modelValue:i.keyword,"onUpdate:modelValue":e[3]||(e[3]=a=>i.keyword=a),placeholder:"搜索供应商名称",clearable:"",style:{width:"250px"}},{append:l(()=>[t(k,{onClick:S},{default:l(()=>[t(A,null,{default:l(()=>[t(d(re))]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),d(r).isAdmin()?(n(),_(g,{key:2},{default:l(()=>[t(k,{type:"success",onClick:e[4]||(e[4]=a=>d(b).push("/suppliers/create"))},{default:l(()=>[...e[8]||(e[8]=[c("新增供应商",-1)])]),_:1})]),_:1})):f("",!0)]),_:1},8,["model"])]),_:1}),ne((n(),v("div",null,[t(Y,{gutter:20},{default:l(()=>[(n(!0),v(E,null,$(V.value,a=>(n(),_(X,{xs:24,sm:12,md:6,key:a.id},{default:l(()=>[t(D,{class:"card-item supplier-card",shadow:"hover"},ue({default:l(()=>[d(r).isAdmin()?f("",!0):(n(),v("div",we,[u("div",he,[t(A,{size:40,color:"#003366"},{default:l(()=>[t(d(ce))]),_:1})]),u("h3",Ce,y(a.companyName),1)])),u("p",xe,y(a.industry),1),u("div",Ve,[t(h,{size:"small",type:"info"},{default:l(()=>[c(y(j(a.scale)),1)]),_:2},1024),d(r).isAdmin()?(n(),_(h,{key:1,type:J(a.status),size:"small",style:{"margin-left":"5px"}},{default:l(()=>[c(y(H(a.status)),1)]),_:2},1032,["type"])):(n(),_(h,{key:0,size:"small",type:"success",style:{"margin-left":"5px"}},{default:l(()=>[c(y(a.qualificationLevel||"认证供应商"),1)]),_:2},1024))]),u("div",ze,[d(r).isAdmin()?f("",!0):(n(),_(k,{key:0,type:"primary",plain:"",size:"small",onClick:C=>G(a)},{default:l(()=>[...e[12]||(e[12]=[c(" 联系供应商 ",-1)])]),_:1},8,["onClick"])),t(k,{type:"primary",link:"",size:"small",onClick:C=>R(a.id)},{default:l(()=>[c(y(d(r).isAdmin()?"查看详情":"详情"),1)]),_:1},8,["onClick"])])]),_:2},[d(r).isAdmin()?{name:"header",fn:l(()=>[u("div",ke,[u("span",be,y(a.companyName),1),t(W,{trigger:"click",onCommand:C=>T(C,a.id)},{dropdown:l(()=>[t(Q,null,{default:l(()=>[t(L,{command:"edit"},{default:l(()=>[...e[9]||(e[9]=[c("编辑",-1)])]),_:1}),t(L,{command:"audit"},{default:l(()=>[...e[10]||(e[10]=[c("审核",-1)])]),_:1}),t(L,{command:"delete"},{default:l(()=>[...e[11]||(e[11]=[c("删除",-1)])]),_:1})]),_:1})]),default:l(()=>[t(k,{type:"primary",link:"",size:"small"},{default:l(()=>[t(A,null,{default:l(()=>[t(d(pe))]),_:1})]),_:1})]),_:1},8,["onCommand"])])]),key:"0"}:void 0]),1024)]),_:2},1024))),128))]),_:1}),V.value.length===0?(n(),_(Z,{key:0,description:"暂无相关供应商信息"})):f("",!0),u("div",Ae,[t(ee,{"current-page":p.page,"onUpdate:currentPage":e[5]||(e[5]=a=>p.page=a),"page-size":p.size,"onUpdate:pageSize":e[6]||(e[6]=a=>p.size=a),total:p.total,layout:"total, prev, pager, next, jumper",onCurrentChange:w},null,8,["current-page","page-size","total"])])])),[[te,x.value]])])}}},Ue=le(Le,[["__scopeId","data-v-aabee47d"]]);export{Ue as default};
