import{_ as L,r as C,a as x,j as M,c as h,o as i,d as t,w as o,e as p,u as T,n as A,b as P,p as R,k as c,l as _,g as s,m as z,F as q,q as I,E as G}from"./index-BfjmpUK-.js";import{u as H}from"./user-Dq3sK-8Q.js";import{g as J,d as K}from"./supplier-B0q6gocU.js";import"./request-CvP5yQdq.js";const O={class:"page-container"},Q={class:"search-bar"},W={__name:"List",setup(X){const g=T(),k=H(),y=C(!1),w=C([]),m=x({keyword:""}),l=x({page:1,size:10,total:0}),u=async()=>{y.value=!0;try{const n=await J({page:l.page,size:l.size,keyword:m.keyword});w.value=n.records,l.total=n.total}catch(n){console.error("加载数据失败",n)}finally{y.value=!1}},b=()=>{l.page=1,u()},V=()=>{m.keyword="",b()},B=()=>{g.push("/suppliers/create")},S=n=>{g.push(`/suppliers/detail/${n}`)},N=n=>{g.push(`/suppliers/edit/${n}`)},D=async n=>{try{await I.confirm("确认删除该供应商吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),await K(n),G.success("删除成功"),u()}catch(e){e!=="cancel"&&console.error("删除失败",e)}};return M(()=>{u()}),(n,e)=>{const E=p("el-input"),d=p("el-button"),r=p("el-table-column"),f=p("el-tag"),$=p("el-table"),U=p("el-pagination"),j=p("el-card"),F=A("loading");return i(),h("div",O,[t(j,null,{default:o(()=>[P("div",Q,[t(E,{modelValue:m.keyword,"onUpdate:modelValue":e[0]||(e[0]=a=>m.keyword=a),placeholder:"搜索公司名称、统一社会信用代码",style:{width:"300px","margin-right":"10px"},clearable:""},null,8,["modelValue"]),t(d,{type:"primary",onClick:b},{default:o(()=>[...e[3]||(e[3]=[s("搜索",-1)])]),_:1}),t(d,{onClick:V},{default:o(()=>[...e[4]||(e[4]=[s("重置",-1)])]),_:1}),z(k).isAdmin()?(i(),c(d,{key:0,type:"success",onClick:B,style:{float:"right"}},{default:o(()=>[...e[5]||(e[5]=[s(" 新建供应商 ",-1)])]),_:1})):_("",!0)]),R((i(),c($,{data:w.value,style:{width:"100%","margin-top":"20px"}},{default:o(()=>[t(r,{prop:"companyName",label:"公司名称","min-width":"200"}),t(r,{prop:"companyCode",label:"统一社会信用代码",width:"200"}),t(r,{prop:"industry",label:"行业",width:"120"}),t(r,{prop:"contactName",label:"联系人",width:"100"}),t(r,{prop:"contactPhone",label:"联系电话",width:"130"}),t(r,{prop:"status",label:"状态",width:"100"},{default:o(({row:a})=>[a.status===0?(i(),c(f,{key:0,type:"warning"},{default:o(()=>[...e[6]||(e[6]=[s("待审核",-1)])]),_:1})):a.status===1?(i(),c(f,{key:1,type:"success"},{default:o(()=>[...e[7]||(e[7]=[s("已认证",-1)])]),_:1})):a.status===2?(i(),c(f,{key:2,type:"danger"},{default:o(()=>[...e[8]||(e[8]=[s("已拒绝",-1)])]),_:1})):_("",!0)]),_:1}),t(r,{label:"操作",width:"200",fixed:"right"},{default:o(({row:a})=>[t(d,{link:"",type:"primary",onClick:v=>S(a.id)},{default:o(()=>[...e[9]||(e[9]=[s("查看",-1)])]),_:1},8,["onClick"]),z(k).isAdmin()?(i(),h(q,{key:0},[t(d,{link:"",type:"primary",onClick:v=>N(a.id)},{default:o(()=>[...e[10]||(e[10]=[s("编辑",-1)])]),_:1},8,["onClick"]),t(d,{link:"",type:"danger",onClick:v=>D(a.id)},{default:o(()=>[...e[11]||(e[11]=[s("删除",-1)])]),_:1},8,["onClick"])],64)):_("",!0)]),_:1})]),_:1},8,["data"])),[[F,y.value]]),t(U,{"current-page":l.page,"onUpdate:currentPage":e[1]||(e[1]=a=>l.page=a),"page-size":l.size,"onUpdate:pageSize":e[2]||(e[2]=a=>l.size=a),total:l.total,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",onSizeChange:u,onCurrentChange:u,style:{"margin-top":"20px","justify-content":"flex-end"}},null,8,["current-page","page-size","total"])]),_:1})])}}},ae=L(W,[["__scopeId","data-v-b9c08d10"]]);export{ae as default};
