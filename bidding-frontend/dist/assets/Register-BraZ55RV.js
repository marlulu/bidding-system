import{_ as q,r as f,b as C,s as S,k as g,o as i,h as p,g as l,w as s,e as t,f as B,m as L,j as d,F,v as M,d as A,i as j,X as D,E as c}from"./index-Dg0MfX17.js";import{f as O}from"./supplier-Brz4Qjp8.js";const T={class:"register-container"},X={class:"register-box"},$={key:0,class:"supplier-info"},z={class:"login-link"},G={__name:"Register",setup(H){const _=B(),w=f(null),m=f(!1),v=f([]),o=C({username:"",password:"",confirmPassword:"",realName:"",role:"SUPPLIER",supplierId:null}),b={username:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}],confirmPassword:[{validator:(u,e,a)=>{e===""?a(new Error("请再次输入密码")):e!==o.password?a(new Error("两次输入密码不一致!")):a()},trigger:"blur"}],realName:[{required:!0,message:"请输入真实姓名",trigger:"blur"}],role:[{required:!0,message:"请选择角色",trigger:"change"}],supplierId:[{required:!0,message:"请选择所属供应商",trigger:"change"}]},y=async()=>{try{v.value=await O()}catch(u){console.error("加载供应商失败",u)}},P=async()=>{try{await w.value.validate(),m.value=!0,await D(o),c.success("注册成功，请等待管理员审核"),_.push("/")}catch(u){c.error(u.message||"注册失败")}finally{m.value=!1}};return S(()=>{y()}),(u,e)=>{const a=t("el-input"),n=t("el-form-item"),V=t("el-radio"),N=t("el-radio-group"),k=t("el-divider"),I=t("el-option"),R=t("el-select"),U=t("el-button"),E=t("el-link"),x=t("el-form");return i(),g("div",T,[p("div",X,[e[14]||(e[14]=p("h2",{class:"register-title"},"用户注册",-1)),l(x,{ref_key:"formRef",ref:w,model:o,rules:b,"label-position":"top"},{default:s(()=>[l(n,{label:"用户名",prop:"username"},{default:s(()=>[l(a,{modelValue:o.username,"onUpdate:modelValue":e[0]||(e[0]=r=>o.username=r),placeholder:"请输入用户名"},null,8,["modelValue"])]),_:1}),l(n,{label:"密码",prop:"password"},{default:s(()=>[l(a,{modelValue:o.password,"onUpdate:modelValue":e[1]||(e[1]=r=>o.password=r),type:"password","show-password":"",placeholder:"请输入密码"},null,8,["modelValue"])]),_:1}),l(n,{label:"确认密码",prop:"confirmPassword"},{default:s(()=>[l(a,{modelValue:o.confirmPassword,"onUpdate:modelValue":e[2]||(e[2]=r=>o.confirmPassword=r),type:"password","show-password":"",placeholder:"请再次输入密码"},null,8,["modelValue"])]),_:1}),l(n,{label:"真实姓名",prop:"realName"},{default:s(()=>[l(a,{modelValue:o.realName,"onUpdate:modelValue":e[3]||(e[3]=r=>o.realName=r),placeholder:"请输入真实姓名"},null,8,["modelValue"])]),_:1}),l(n,{label:"注册角色",prop:"role"},{default:s(()=>[l(N,{modelValue:o.role,"onUpdate:modelValue":e[4]||(e[4]=r=>o.role=r)},{default:s(()=>[l(V,{label:"SUPPLIER"},{default:s(()=>[...e[7]||(e[7]=[d("供应商",-1)])]),_:1}),l(V,{label:"ADMIN"},{default:s(()=>[...e[8]||(e[8]=[d("管理员",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),o.role==="SUPPLIER"?(i(),g("div",$,[l(k,null,{default:s(()=>[...e[9]||(e[9]=[d("供应商信息",-1)])]),_:1}),l(n,{label:"关联供应商",prop:"supplierId"},{default:s(()=>[l(R,{modelValue:o.supplierId,"onUpdate:modelValue":e[5]||(e[5]=r=>o.supplierId=r),placeholder:"请选择所属供应商",style:{width:"100%"}},{default:s(()=>[(i(!0),g(F,null,M(v.value,r=>(i(),A(I,{key:r.id,label:r.companyName,value:r.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),e[10]||(e[10]=p("div",{class:"tips"},"如果没有您的公司，请先联系管理员录入供应商信息。",-1))]),_:1})])):L("",!0),l(U,{type:"primary",loading:m.value,onClick:P,style:{width:"100%","margin-top":"20px"}},{default:s(()=>[...e[11]||(e[11]=[d(" 立即注册 ",-1)])]),_:1},8,["loading"]),p("div",z,[e[13]||(e[13]=d(" 已有账号？",-1)),l(E,{type:"primary",onClick:e[6]||(e[6]=r=>j(_).push("/"))},{default:s(()=>[...e[12]||(e[12]=[d("返回登录",-1)])]),_:1})])]),_:1},8,["model"])])])}}},W=q(G,[["__scopeId","data-v-da2a20d1"]]);export{W as default};
