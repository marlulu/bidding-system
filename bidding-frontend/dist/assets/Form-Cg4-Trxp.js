import{_ as L,r as m,a as U,j as x,c as V,o as p,d as t,w as l,e as n,u as M,k as v,l as P,g as d,F as R,s as A,b as B,E as F}from"./index-BfjmpUK-.js";import{c as q}from"./notice-CqPt9wmV.js";import{a as O}from"./supplier-B0q6gocU.js";import"./request-CvP5yQdq.js";const Y={class:"page-container"},j={__name:"Form",setup(D){const c=M(),_=m(null),i=m(!1),f=m([]),o=U({title:"",type:"SYSTEM",targetType:"ALL",targetSupplierIds:[],content:""}),I={title:[{required:!0,message:"请输入标题",trigger:"blur"}],type:[{required:!0,message:"请选择通知类型",trigger:"change"}],content:[{required:!0,message:"请输入内容",trigger:"blur"}]},N=async()=>{try{f.value=await O()}catch(r){console.error("加载供应商列表失败",r)}},k=async()=>{try{await _.value.validate(),i.value=!0;const r={...o};r.targetSupplierIds&&r.targetSupplierIds.length>0?r.targetSupplierIds=JSON.stringify(r.targetSupplierIds):r.targetSupplierIds=null,await q(r),F.success("创建成功"),c.push("/notices")}catch(r){console.error("提交失败",r)}finally{i.value=!1}},E=()=>{c.back()};return x(()=>{N()}),(r,e)=>{const g=n("el-input"),s=n("el-form-item"),u=n("el-option"),y=n("el-select"),b=n("el-radio"),T=n("el-radio-group"),S=n("el-button"),w=n("el-form"),C=n("el-card");return p(),V("div",Y,[t(C,null,{header:l(()=>[...e[5]||(e[5]=[B("span",null,"新建系统通知",-1)])]),default:l(()=>[t(w,{ref_key:"formRef",ref:_,model:o,rules:I,"label-width":"120px"},{default:l(()=>[t(s,{label:"标题",prop:"title"},{default:l(()=>[t(g,{modelValue:o.title,"onUpdate:modelValue":e[0]||(e[0]=a=>o.title=a),placeholder:"请输入标题"},null,8,["modelValue"])]),_:1}),t(s,{label:"通知类型",prop:"type"},{default:l(()=>[t(y,{modelValue:o.type,"onUpdate:modelValue":e[1]||(e[1]=a=>o.type=a),placeholder:"请选择通知类型"},{default:l(()=>[t(u,{label:"系统通知",value:"SYSTEM"}),t(u,{label:"政策变动",value:"POLICY"}),t(u,{label:"公告提醒",value:"ANNOUNCEMENT"})]),_:1},8,["modelValue"])]),_:1}),t(s,{label:"目标类型",prop:"targetType"},{default:l(()=>[t(T,{modelValue:o.targetType,"onUpdate:modelValue":e[2]||(e[2]=a=>o.targetType=a)},{default:l(()=>[t(b,{label:"ALL"},{default:l(()=>[...e[6]||(e[6]=[d("全部用户",-1)])]),_:1}),t(b,{label:"SUPPLIER"},{default:l(()=>[...e[7]||(e[7]=[d("指定供应商",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),o.targetType==="SUPPLIER"?(p(),v(s,{key:0,label:"目标供应商",prop:"targetSupplierIds"},{default:l(()=>[t(y,{modelValue:o.targetSupplierIds,"onUpdate:modelValue":e[3]||(e[3]=a=>o.targetSupplierIds=a),multiple:"",placeholder:"请选择目标供应商",style:{width:"100%"}},{default:l(()=>[(p(!0),V(R,null,A(f.value,a=>(p(),v(u,{key:a.id,label:a.companyName,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):P("",!0),t(s,{label:"内容",prop:"content"},{default:l(()=>[t(g,{modelValue:o.content,"onUpdate:modelValue":e[4]||(e[4]=a=>o.content=a),type:"textarea",rows:10,placeholder:"请输入通知内容"},null,8,["modelValue"])]),_:1}),t(s,null,{default:l(()=>[t(S,{type:"primary",onClick:k,loading:i.value},{default:l(()=>[...e[8]||(e[8]=[d("提交",-1)])]),_:1},8,["loading"]),t(S,{onClick:E},{default:l(()=>[...e[9]||(e[9]=[d("取消",-1)])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})])}}},K=L(j,[["__scopeId","data-v-0c7c433d"]]);export{K as default};
