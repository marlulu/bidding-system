import{_ as j,r as x,a as E,j as H,c as T,o as s,d as n,w as a,e as p,u as P,n as G,b as K,p as q,k as r,l as g,f as O,g as l,m as B,F as J,q as z,E as A}from"./index-BfjmpUK-.js";import{u as Q}from"./user-Dq3sK-8Q.js";import{g as W,p as X,d as Y}from"./announcement-MtC48bol.js";import"./request-CvP5yQdq.js";const Z={class:"page-container"},ee={class:"search-bar"},te={__name:"List",setup(ne){const k=P(),C=Q(),_=x(!1),w=x([]),u=E({keyword:"",type:""}),i=E({page:1,size:10,total:0}),m=async()=>{_.value=!0;try{const o=await W({page:i.page,size:i.size,keyword:u.keyword,type:u.type});w.value=o.records,i.total=o.total}catch(o){console.error("加载数据失败",o)}finally{_.value=!1}},b=()=>{i.page=1,m()},D=()=>{u.keyword="",u.type="",b()},V=()=>{k.push("/announcements/create")},N=o=>{k.push(`/announcements/detail/${o}`)},S=o=>{k.push(`/announcements/edit/${o}`)},R=async o=>{try{await z.confirm("确认发布该公告吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),await X(o),A.success("发布成功"),m()}catch(e){e!=="cancel"&&console.error("发布失败",e)}},U=async o=>{try{await z.confirm("确认删除该公告吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),await Y(o),A.success("删除成功"),m()}catch(e){e!=="cancel"&&console.error("删除失败",e)}};return H(()=>{m()}),(o,e)=>{const h=p("el-input"),f=p("el-option"),L=p("el-select"),d=p("el-button"),c=p("el-table-column"),y=p("el-tag"),I=p("el-table"),$=p("el-pagination"),F=p("el-card"),M=G("loading");return s(),T("div",Z,[n(F,null,{default:a(()=>[K("div",ee,[n(h,{modelValue:u.keyword,"onUpdate:modelValue":e[0]||(e[0]=t=>u.keyword=t),placeholder:"搜索标题、公告编号、项目名称",style:{width:"300px","margin-right":"10px"},clearable:"",onKeyup:O(b,["enter"])},null,8,["modelValue"]),n(L,{modelValue:u.type,"onUpdate:modelValue":e[1]||(e[1]=t=>u.type=t),placeholder:"公告类型",style:{width:"150px","margin-right":"10px"},clearable:""},{default:a(()=>[n(f,{label:"招标公告",value:"BID"}),n(f,{label:"变更公告",value:"CHANGE"}),n(f,{label:"终止公告",value:"TERMINATE"}),n(f,{label:"中标结果",value:"RESULT"})]),_:1},8,["modelValue"]),n(d,{type:"primary",onClick:b},{default:a(()=>[...e[4]||(e[4]=[l("搜索",-1)])]),_:1}),n(d,{onClick:D},{default:a(()=>[...e[5]||(e[5]=[l("重置",-1)])]),_:1}),B(C).isAdmin()?(s(),r(d,{key:0,type:"success",onClick:V,style:{float:"right"}},{default:a(()=>[...e[6]||(e[6]=[l(" 新建公告 ",-1)])]),_:1})):g("",!0)]),q((s(),r(I,{data:w.value,style:{width:"100%","margin-top":"20px"}},{default:a(()=>[n(c,{prop:"announcementNo",label:"公告编号",width:"150"}),n(c,{prop:"title",label:"标题","min-width":"200"}),n(c,{prop:"type",label:"类型",width:"100"},{default:a(({row:t})=>[t.type==="BID"?(s(),r(y,{key:0,type:"primary"},{default:a(()=>[...e[7]||(e[7]=[l("招标公告",-1)])]),_:1})):t.type==="CHANGE"?(s(),r(y,{key:1,type:"warning"},{default:a(()=>[...e[8]||(e[8]=[l("变更公告",-1)])]),_:1})):t.type==="TERMINATE"?(s(),r(y,{key:2,type:"danger"},{default:a(()=>[...e[9]||(e[9]=[l("终止公告",-1)])]),_:1})):t.type==="RESULT"?(s(),r(y,{key:3,type:"success"},{default:a(()=>[...e[10]||(e[10]=[l("中标结果",-1)])]),_:1})):g("",!0)]),_:1}),n(c,{prop:"projectName",label:"项目名称","min-width":"150"}),n(c,{prop:"status",label:"状态",width:"100"},{default:a(({row:t})=>[t.status==="DRAFT"?(s(),r(y,{key:0,type:"info"},{default:a(()=>[...e[11]||(e[11]=[l("草稿",-1)])]),_:1})):t.status==="PUBLISHED"?(s(),r(y,{key:1,type:"success"},{default:a(()=>[...e[12]||(e[12]=[l("已发布",-1)])]),_:1})):t.status==="CLOSED"?(s(),r(y,{key:2,type:"danger"},{default:a(()=>[...e[13]||(e[13]=[l("已关闭",-1)])]),_:1})):g("",!0)]),_:1}),n(c,{prop:"publishTime",label:"发布时间",width:"180"}),n(c,{label:"操作",width:"200",fixed:"right"},{default:a(({row:t})=>[n(d,{link:"",type:"primary",onClick:v=>N(t.id)},{default:a(()=>[...e[14]||(e[14]=[l("查看",-1)])]),_:1},8,["onClick"]),B(C).isAdmin()?(s(),T(J,{key:0},[n(d,{link:"",type:"primary",onClick:v=>S(t.id)},{default:a(()=>[...e[15]||(e[15]=[l("编辑",-1)])]),_:1},8,["onClick"]),t.status==="DRAFT"?(s(),r(d,{key:0,link:"",type:"success",onClick:v=>R(t.id)},{default:a(()=>[...e[16]||(e[16]=[l(" 发布 ",-1)])]),_:1},8,["onClick"])):g("",!0),n(d,{link:"",type:"danger",onClick:v=>U(t.id)},{default:a(()=>[...e[17]||(e[17]=[l("删除",-1)])]),_:1},8,["onClick"])],64)):g("",!0)]),_:1})]),_:1},8,["data"])),[[M,_.value]]),n($,{"current-page":i.page,"onUpdate:currentPage":e[2]||(e[2]=t=>i.page=t),"page-size":i.size,"onUpdate:pageSize":e[3]||(e[3]=t=>i.size=t),total:i.total,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",onSizeChange:m,onCurrentChange:m,style:{"margin-top":"20px","justify-content":"flex-end"}},null,8,["current-page","page-size","total"])]),_:1})])}}},re=j(te,[["__scopeId","data-v-1d1178e7"]]);export{re as default};
