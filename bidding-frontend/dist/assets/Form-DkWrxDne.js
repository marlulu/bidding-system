import{_ as I,r as g,c as h,a as P,b as R,s as U,k as B,o as N,g as e,w as l,e as a,f as O,j as y,h as q,t as D,E as b}from"./index-Dg0MfX17.js";import{a as L,u as j,c as F}from"./policy-CMwfpyrq.js";const G={class:"page-container"},M={__name:"Form",setup(S){const u=P(),p=O(),m=g(null),c=g(!1),d=h(()=>!!u.params.id),t=R({title:"",category:"POLICY",content:""}),v={title:[{required:!0,message:"请输入标题",trigger:"blur"}],category:[{required:!0,message:"请选择分类",trigger:"change"}],content:[{required:!0,message:"请输入内容",trigger:"blur"}]},V=async()=>{if(d.value)try{const r=await L(u.params.id);Object.assign(t,r)}catch(r){console.error("加载数据失败",r)}},w=async()=>{try{await m.value.validate(),c.value=!0,d.value?(await j(u.params.id,t),b.success("更新成功")):(await F(t),b.success("创建成功")),p.push("/policies")}catch(r){console.error("提交失败",r)}finally{c.value=!1}},k=()=>{p.back()};return U(()=>{V()}),(r,o)=>{const _=a("el-input"),n=a("el-form-item"),i=a("el-option"),x=a("el-select"),f=a("el-button"),C=a("el-form"),E=a("el-card");return N(),B("div",G,[e(E,null,{header:l(()=>[q("span",null,D(d.value?"编辑政策法规":"新建政策法规"),1)]),default:l(()=>[e(C,{ref_key:"formRef",ref:m,model:t,rules:v,"label-width":"120px"},{default:l(()=>[e(n,{label:"标题",prop:"title"},{default:l(()=>[e(_,{modelValue:t.title,"onUpdate:modelValue":o[0]||(o[0]=s=>t.title=s),placeholder:"请输入标题"},null,8,["modelValue"])]),_:1}),e(n,{label:"分类",prop:"category"},{default:l(()=>[e(x,{modelValue:t.category,"onUpdate:modelValue":o[1]||(o[1]=s=>t.category=s),placeholder:"请选择分类"},{default:l(()=>[e(i,{label:"政策",value:"POLICY"}),e(i,{label:"法规",value:"REGULATION"}),e(i,{label:"指南",value:"GUIDE"})]),_:1},8,["modelValue"])]),_:1}),e(n,{label:"内容",prop:"content"},{default:l(()=>[e(_,{modelValue:t.content,"onUpdate:modelValue":o[2]||(o[2]=s=>t.content=s),type:"textarea",rows:15,placeholder:"请输入政策法规内容"},null,8,["modelValue"])]),_:1}),e(n,null,{default:l(()=>[e(f,{type:"primary",onClick:w,loading:c.value},{default:l(()=>[...o[3]||(o[3]=[y("提交",-1)])]),_:1},8,["loading"]),e(f,{onClick:k},{default:l(()=>[...o[4]||(o[4]=[y("取消",-1)])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})])}}},A=I(M,[["__scopeId","data-v-f1f03b14"]]);export{A as default};
